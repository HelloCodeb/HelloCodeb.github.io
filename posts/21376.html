<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">



<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"javamianshi.vercel.app","root":"/","scheme":"Gemini","version":"7.8.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":false,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>



  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "bb467ce9"
    });
  daovoice('update');
  </script>

  <meta name="description" content="史上最全Java基础面试题，精心整理100家互联网面经">
<meta property="og:type" content="article">
<meta property="og:title" content="elasticsearch面试题">
<meta property="og:url" content="https://javamianshi.vercel.app/posts/21376.html">
<meta property="og:site_name" content="java学习面试">
<meta property="og:description" content="史上最全Java基础面试题，精心整理100家互联网面经">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-06-13T16:10:53.000Z">
<meta property="article:modified_time" content="2022-06-14T01:12:09.878Z">
<meta property="article:author" content="Java面试题">
<meta property="article:tag" content="elasticsearch面试题">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://javamianshi.vercel.app/posts/21376.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><style>
#needsharebutton-postbottom {
  cursor: pointer;
  height: 26px;
  margin-top: 10px;
  position: relative;
}
#needsharebutton-postbottom .btn {
  border: 1px solid $btn-default-border-color;
  border-radius: 3px;
  display: initial;
  padding: 1px 4px;
}
</style>
  <title>elasticsearch面试题 | java学习面试</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="java学习面试" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">java学习面试</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">关注下方微信公众号，可得10TJava学习资源</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://javamianshi.vercel.app/posts/21376.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avator.jpg">
      <meta itemprop="name" content="Java面试题">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="java学习面试">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          elasticsearch面试题
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-06-14 00:10:53 / 修改时间：09:12:09" itemprop="dateCreated datePublished" datetime="2022-06-14T00:10:53+08:00">2022-06-14</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java%E9%9D%A2%E8%AF%95%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">Java面试题</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/posts/21376.html#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/posts/21376.html" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>20k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>18 分钟</span>
            </span>
            <div class="post-description">史上最全Java基础面试题，精心整理100家互联网面经</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <table>
<thead>
<tr>
<th>Java面试题</th>
<th>面试题链接</th>
</tr>
</thead>
<tbody><tr>
<td>Java基础面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/25692.html">https://javamianshi.vercel.app/posts/25692.html</a></td>
</tr>
<tr>
<td>Java集合容器面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/7192.html">https://javamianshi.vercel.app/posts/7192.html</a></td>
</tr>
<tr>
<td>JVM面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/23494.html">https://javamianshi.vercel.app/posts/23494.html</a></td>
</tr>
<tr>
<td>计算机网络面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/61055.html">https://javamianshi.vercel.app/posts/61055.html</a></td>
</tr>
<tr>
<td>操作系统面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/43996.html">https://javamianshi.vercel.app/posts/43996.html</a></td>
</tr>
<tr>
<td>数据结构面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/63819.html">https://javamianshi.vercel.app/posts/63819.html</a></td>
</tr>
<tr>
<td>设计模式面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/28064.html">https://javamianshi.vercel.app/posts/28064.html</a></td>
</tr>
<tr>
<td>Spring、Spring boot、Spring Cloud面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/48125.html">https://javamianshi.vercel.app/posts/48125.html</a></td>
</tr>
<tr>
<td>Mysql面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/6760.html">https://javamianshi.vercel.app/posts/6760.html</a></td>
</tr>
<tr>
<td>elasticsearch面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/21376.html">https://javamianshi.vercel.app/posts/21376.html</a></td>
</tr>
<tr>
<td>MQ RabbitMq面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/39055.html">https://javamianshi.vercel.app/posts/39055.html</a></td>
</tr>
<tr>
<td>MongoDB面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/7667.html">https://javamianshi.vercel.app/posts/7667.html</a></td>
</tr>
<tr>
<td>Linux面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/5935.html">https://javamianshi.vercel.app/posts/5935.html</a></td>
</tr>
<tr>
<td>Mybatis面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/42129.html">https://javamianshi.vercel.app/posts/42129.html</a></td>
</tr>
<tr>
<td>redis面试题</td>
<td><a href="https://javamianshi.vercel.app/posts/18435.html">https://javamianshi.vercel.app/posts/18435.html</a></td>
</tr>
</tbody></table>
<div class="toc">

<!-- toc -->

<ul>
<li><a href="#elasticsearch-liao-jie-duo-shao-shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan">elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</a><ul>
<li><a href="#she-ji-jie-duan-diao-you">设计阶段调优</a></li>
<li><a href="#xie-ru-diao-you">写入调优</a></li>
<li><a href="#cha-xun-diao-you">查询调优</a></li>
<li><a href="#qi-ta-diao-you">其他调优</a></li>
<li><a href="#jian-yao-jie-shao-yi-xia-elasticsearch">简要介绍一下Elasticsearch?</a></li>
<li><a href="#an-zhuang-elasticsearch-xu-yao-yi-lai-shi-me-zu-jian-ma">安装 Elasticsearch 需要依赖什么组件吗?</a></li>
<li><a href="#ru-he-qi-dong-elasticsearch-fu-wu-qi-qi-dong-fang-shi-you-hen-duo-chong-yi-ban-bin-lu-jing-xia">如何启动 Elasticsearch 服务器? 启动方式有很多种，一般 bin 路径下</a></li>
<li><a href="#elasticsearch-zhong-de-ji-qun-jie-dian-suo-yin-wen-dang-lei-xing-shi-shi-me">ElasticSearch中的集群、节点、索引、文档、类型是什么?</a></li>
<li><a href="#elasticsearch-zhi-chi-na-xie-lei-xing-de-cha-xun">Elasticsearch 支持哪些类型的查询?</a></li>
<li><a href="#jing-zhun-pi-pei-jian-suo-he-quan-wen-jian-suo-pi-pei-jian-suo-de-bu-tong">精准匹配检索和全文检索匹配检索的不同?</a></li>
<li><a href="#elasticsearch-zhong-de-jie-dian-bi-ru-gong-20-ge-qi-zhong-de-10-ge-xuan-liao-yi-ge-master-ling-wai-10-ge-xuan-liao-ling-yi-ge-master-zen-me-ban">Elasticsearch 中的节点（比如共 20 个），其中的 10 个选了一个 master，另外 10 个选了另一个 master，怎么办？</a></li>
<li><a href="#elasticsearch-zhong-de-fen-pian-shi-shi-me-zai-da-duo-shu-huan-jing-zhong-mei-ge-jie-dian-du-zai-dan-du-de-he-zi-huo-xu-ni-ji-shang-yun-xing">ElasticSearch中的分片是什么? 在大多数环境中，每个节点都在单独的盒子或虚拟机上运行。</a></li>
<li><a href="#qing-jie-shi-yi-xia-elasticsearch-zhong-ju-he-ju-he-you-zhu-yu-cong-sou-suo-zhong-shi-yong-de-cha-xun-zhong-shou-ji-shu-ju-ju-he-wei-ge-chong-tong-ji-zhi-biao-bian-yu-tong-ji-xin-xi-huo-zuo-qi-ta-fen-xi-ju-he">请解释一下 Elasticsearch 中聚合? 聚合有助于从搜索中使用的查询中收集数据，聚合为各种统计指标，便于统计信息或做其他分析。聚合</a></li>
<li><a href="#jie-shi-yi-xia-elasticsearch-cluster">解释一下Elasticsearch Cluster?</a></li>
<li><a href="#jie-shi-yi-xia-elasticsearch-ji-qun-zhong-de-type-de-gai-nian">解释一下 Elasticsearch 集群中的 Type 的概念 ?</a></li>
<li><a href="#ke-hu-duan-zai-he-ji-qun-lian-jie-shi-ru-he-xuan-ze-te-ding-de-jie-dian-zhi-xing-qing-qiu-de">客户端在和集群连接时，如何选择特定的节点执行请求的？</a></li>
<li><a href="#jie-shi-yi-xia-elasticsearch-de-fen-pian-dang-wen-dang-shu-liang-zeng-jia-ying-pan-rong-liang-he-chu-li-neng-li-bu-zu-shi-dui-ke-hu-duan-qing-qiu-de-xiang-ying-jiang-yan-chi">解释一下 Elasticsearch 的 分片? 当文档数量增加，硬盘容量和处理能力不足时，对客户端请求的响应将延迟。</a></li>
</ul>
<ul>
<li><a href="#ding-yi-fu-ben-chuang-jian-fu-ben-de-hao-chu-shi-shi-me">定义副本、创建副本的好处是什么?</a><ul>
<li><a href="#elasticsearch-analyzer-zhong-de-zi-fu-guo-lu-qi-ru-he-li-yong">Elasticsearch Analyzer 中的字符过滤器如何利用?</a></li>
<li><a href="#rest-api-zai-elasticsearch-fang-mian-you-na-xie-you-shi">REST API在 Elasticsearch 方面有哪些优势?</a></li>
<li><a href="#elasticsearch-zhong-chang-yong-de-cat-ming-ling-you-na-xie">Elasticsearch 中常用的 cat命令有哪些?</a></li>
<li><a href="#ni-neng-fou-lie-chu-yu-elasticsearch-you-guan-de-zhu-yao-ke-yong-zi-duan-shu-ju-lei-xing">你能否列出与 Elasticsearch 有关的主要可用字段数据类型?</a></li>
<li><a href="#elasticsearch-liao-jie-duo-shao-shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan">Elasticsearch了解多少，说说你们公司es的集群架构，索引数据 大小，分片有多少，以及一些调优手段 。</a><ul>
<li><a href="#xie-ru-diao-you-1">写入调优</a></li>
<li><a href="#cha-xun-diao-you-1">查询调优</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#xiang-xi-miao-shu-yi-xia-elasticsearch-sou-suo-de-guo-cheng">详细描述一下 Elasticsearch 搜索的过程？</a><ul>
<li><a href="#elasticsearch-zai-bu-shu-shi-dui-linux-de-she-zhi-you-na-xie-you-hua-fang-fa">Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</a></li>
<li><a href="#jie-shi-yi-xia-elasticsearch-ji-qun-zhong-de-suo-yin-de-gai-nian">解释一下 Elasticsearch集群中的 索引的概念 ?</a></li>
<li><a href="#lucence-nei-bu-jie-gou-shi-shi-me">lucence 内部结构是什么</a></li>
<li><a href="#elasticsearch-shi-ru-he-shi-xian-master-xuan-ju-de">Elasticsearch 是如何实现 Master 选举的？</a></li>
<li><a href="#elasticsearch-suo-yin-shu-ju-duo-liao-zen-me-ban-ru-he-diao-you-bu-shu">Elasticsearch 索引数据多了怎么办，如何调优，部署</a></li>
<li><a href="#zai-elasticsearch-zhong-shan-chu-suo-yin-de-yu-fa-shi-shi-me-ke-yi-shi-yong-yi-xia-yu-fa-shan-chu-xian-you-suo-yin">在 Elasticsearch 中删除索引的语法是什么? 可以使用以下语法删除现有索引:</a></li>
<li><a href="#zai-elasticsearch-zhong-lie-chu-ji-qun-de-suo-you-suo-yin-de-yu-fa-shi-shi-me">在 Elasticsearch 中列出集群的所有索引的语法是什么?</a></li>
<li><a href="#zai-suo-yin-zhong-geng-xin-mapping-de-yu-fa">在索引中更新 Mapping 的语法?</a></li>
<li><a href="#es-xie-shu-ju-guo-cheng">ES 写数据过程</a></li>
<li><a href="#es-du-shu-ju-guo-cheng-ke-yi-tong-guo-lai-cha-xun-hui-gen-ju">ES 读数据过程 可以通过 来查询，会根据</a></li>
<li><a href="#es-zhong-de-dao-pai-suo-yin-shi-shi-me">ES中的倒排索引是什么?</a></li>
<li><a href="#qing-jie-shi-zai-elasticsearch-ji-qun-zhong-tian-jia-huo-chuang-jian-suo-yin-de-guo-cheng-yao-tian-jia-xin-suo-yin-ying-shi-yong-chuang-jian-suo-yin-api-xuan-xiang-chuang-jian-suo-yin-suo-xu-de-can-shu-shi-suo-yin-de-pei-zhi-settings-suo-yin-zhong-de-zi-duan">请解释在 Elasticsearch 集群中添加或创建索引的过程? 要添加新索引，应使用创建索引 API 选项。创建索引所需的参数是索引的配置Settings，索引中的字段</a></li>
<li><a href="#xiang-xi-miao-shu-yi-xia-elasticsearch-suo-yin-wen-dang-de-guo-cheng">详细描述一下Elasticsearch索引文档的过程。</a></li>
<li><a href="#xiang-xi-miao-shu-yi-xia-elasticsearch-sou-suo-de-guo-cheng-sou-suo-bei-zhi-xing-cheng-yi-ge-liang-jie-duan-guo-cheng-wo-men-cheng-zhi-wei-query-then-fetch">详细描述一下Elasticsearch搜索的过程 搜索被执行成一个两阶段过程，我们称之为 Query Then Fetch;</a></li>
<li><a href="#elasticsearch-dui-yu-da-shu-ju-liang-shang-yi-liang-ji-de-ju-he-ru-he-shi-xian">Elasticsearch对于大数据量(上亿量级)的聚合如何实现?</a></li>
<li><a href="#ni-ke-yi-lie-chu-elasticsearch-ge-chong-lei-xing-de-fen-xi-qi-ma">你可以列出 Elasticsearch 各种类型的分析器吗?</a></li>
<li><a href="#es-shi-ru-he-shi-xian-master-xuan-ju-de">ES是如何实现master选举的?</a></li>
<li><a href="#master-jie-dian-he-hou-xuan-master-jie-dian-you-shi-me-qu-bie-zhu-jie-dian-fu-ze-ji-qun-xiang-guan-de-cao-zuo-li-ru-chuang-jian-huo-shan-chu-suo-yin-gen-zong-na-xie-jie-dian-shi-ji-qun-de-yi-bu-fen-yi-ji-jue-ding-jiang-na-xie-fen-pian-fen-pei-gei-na-xie-jie-dian">Master 节点和 候选 Master节点有什么区别? 主节点负责集群相关的操作，例如创建或删除索引，跟踪哪些节点是集群的一部分，以及决定将哪些分片分配给哪些节点。</a></li>
<li><a href="#elasticsearch-zhong-de-shu-xing-enabled-index-he-store-de-gong-neng-shi-shi-me">Elasticsearch中的属性 enabled, index 和 store 的功能是什 么?</a></li>
<li><a href="#elasticsearch-zhong-de-jie-dian-bi-ru-gong-20-ge-qi-zhong-de-10-ge-xuan-liao-yi-ge-master-ling-wai-10-ge-xuan-liao-ling-yi-ge-master-zen-me-ban">Elasticsearch中的节点(比如共20个)，其中的10个选了一个 master，另外10个选了另一个master，怎么办?</a></li>
<li><a href="#ru-he-jie-jue-es-ji-qun-de-nao-lie-wen-ti">如何解决ES集群的脑裂问题</a></li>
<li><a href="#xiang-xi-miao-shu-yi-xia-es-suo-yin-wen-dang-de-guo-cheng">详细描述一下ES索引文档的过程?</a></li>
<li><a href="#xiang-xi-miao-shu-yi-xia-es-geng-xin-he-shan-chu-wen-dang-de-guo-cheng">详细描述一下ES更新和删除文档的过程?</a></li>
<li><a href="#xiang-xi-miao-shu-yi-xia-es-sou-suo-de-guo-cheng">详细描述一下ES搜索的过程?</a></li>
<li><a href="#zai-bing-fa-qing-kuang-xia-es-ru-guo-bao-zheng-du-xie-yi-zhi">在并发情况下，ES如果保证读写一致?</a></li>
<li><a href="#es-dui-yu-da-shu-ju-liang-shang-yi-liang-ji-de-ju-he-ru-he-shi-xian">ES对于大数据量(上亿量级)的聚合如何实现?</a></li>
<li><a href="#dui-yu-gc-fang-mian-zai-shi-yong-es-shi-yao-zhu-yi-shi-me">对于GC方面，在使用ES时要注意什么?</a></li>
<li><a href="#shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan">说说你们公司ES的集群架构，索引数据大小，分片有多少，以及 一些调优手段?</a></li>
<li><a href="#zai-bing-fa-qing-kuang-xia-elasticsearch-ru-guo-bao-zheng-du-xie-yi-zhi-ke-yi-tong-guo-ban-ben-hao-shi-yong-le-guan-bing-fa-kong-zhi-yi-que-bao-xin-ban-ben-bu-hui-bei-jiu-ban-ben-fu-gai-you-ying-yong-ceng-lai-chu-li-ju-ti-de-chong-tu">在并发情况下，Elasticsearch如果保证读写一致? 可以通过版本号使用乐观并发控制，以确保新版本不会被旧版本覆盖，由应用层来处理具体的冲突;</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div>

<p>ElasticSearch面试题</p>
<h2><span id="elasticsearch-liao-jie-duo-shao-shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan">elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</span><a href="#elasticsearch-liao-jie-duo-shao-shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan" class="header-anchor">#</a></h2><p>面试官：想了解应聘者之前公司接触的 ES 使用场景、规模，有没有做过比较大规模的索引设计、规划、调优。<br>解答：如实结合自己的实践场景回答即可。<br>比如：ES 集群架构 13 个节点，索引根据通道不同共 20+索引，根据日期，每日递增 20+，索引：10分片，每日递增 1 亿+数据，每个通道每天索引大小控制：150GB 之内。<br>仅索引层面调优手段：</p>
<h4><span id="she-ji-jie-duan-diao-you">设计阶段调优</span><a href="#she-ji-jie-duan-diao-you" class="header-anchor">#</a></h4><p>（1）根据业务增量需求，采取基于日期模板创建索引，通过 roll over API 滚动索引；</p>
<p>（2）使用别名进行索引管理；</p>
<p>（3）每天凌晨定时对索引做 force_merge 操作，以释放空间；</p>
<p>（4）采取冷热分离机制，热数据存储到 SSD，提高检索效率；冷数据定期进行 shrink操作，以缩减存储；</p>
<p>（5）采取 curator 进行索引的生命周期管理；</p>
<p>（6）仅针对需要分词的字段，合理的设置分词器；</p>
<p>（7）Mapping 阶段充分结合各个字段的属性，是否需要检索、是否需要存储等。</p>
<h4><span id="xie-ru-diao-you">写入调优</span><a href="#xie-ru-diao-you" class="header-anchor">#</a></h4><p>（1）写入前副本数设置为 0；</p>
<p>（2）写入前关闭 refresh_interval 设置为-1，禁用刷新机制；</p>
<p>（3）写入过程中：采取 bulk 批量写入；</p>
<p>（4）写入后恢复副本数和刷新间隔；</p>
<p>（5）尽量使用自动生成的 id。</p>
<h4><span id="cha-xun-diao-you">查询调优</span><a href="#cha-xun-diao-you" class="header-anchor">#</a></h4><p>（1）禁用 wildcard；</p>
<p>（2）禁用批量 terms（成百上千的场景）；</p>
<p>（3）充分利用倒排索引机制，能 keyword 类型尽量 keyword；</p>
<p>（4）数据量大时候，可以先基于时间敲定索引再检索；</p>
<p>（5）设置合理的路由机制。</p>
<h4><span id="qi-ta-diao-you">其他调优</span><a href="#qi-ta-diao-you" class="header-anchor">#</a></h4><p>部署调优，业务调优等。<br>上面的提及一部分，面试者就基本对你之前的实践或者运维经验有所评估了。</p>
<h4><span id="jian-yao-jie-shao-yi-xia-elasticsearch">简要介绍一下Elasticsearch?</span><a href="#jian-yao-jie-shao-yi-xia-elasticsearch" class="header-anchor">#</a></h4><p>Elasticsearch 是一个分布式、RESTful 风格的搜索和数据分析引擎，能够解决不断涌现出的各种用例。</p>
<p>作为 Elastic Stack 的核心，它集中存储您的数据，帮助您发现意料之中以及意料之外的情况。</p>
<p>ElasticSearch 是基于Lucene的搜索服务器。它提供了一个分布式多用户能力的全文搜索引擎，基于 RESTful web接口。Elasticsearch是用Java开发的，并作为Apache许可条款下的开放源码发布，是当前 流行的企业级搜索引擎。</p>
<p>核心特点如下:</p>
<p>分布式的实时文件存储，每个字段都被索引且可用于搜索。 分布式的实时分析搜索引擎，海量数据下近实时秒级响应。 简单的restful api，天生的兼容多语言开发。 易扩展，处理PB级结构化或非结构化数据。</p>
<h4><span id="an-zhuang-elasticsearch-xu-yao-yi-lai-shi-me-zu-jian-ma">安装 Elasticsearch 需要依赖什么组件吗?</span><a href="#an-zhuang-elasticsearch-xu-yao-yi-lai-shi-me-zu-jian-ma" class="header-anchor">#</a></h4><p> ES 早期版本需要JDK，在7.X版本后已经集成了 JDK，已无需第三方依赖。</p>
<h4><span id="ru-he-qi-dong-elasticsearch-fu-wu-qi-qi-dong-fang-shi-you-hen-duo-chong-yi-ban-bin-lu-jing-xia">如何启动 Elasticsearch 服务器? 启动方式有很多种，一般 bin 路径下</span><a href="#ru-he-qi-dong-elasticsearch-fu-wu-qi-qi-dong-fang-shi-you-hen-duo-chong-yi-ban-bin-lu-jing-xia" class="header-anchor">#</a></h4><p>就可以后台启动。<br> 打开浏览器输入 <span class="exturl" data-url="aHR0cDovL2VzLw==" title="http://es/">http://ES<i class="fa fa-external-link"></i></span> IP:9200 就能知道集群是否启动成功。 如果启动报错，日志里会有详细信息，逐条核对解决就可以。</p>
<h4><span id="elasticsearch-zhong-de-ji-qun-jie-dian-suo-yin-wen-dang-lei-xing-shi-shi-me">ElasticSearch中的集群、节点、索引、文档、类型是什么?</span><a href="#elasticsearch-zhong-de-ji-qun-jie-dian-suo-yin-wen-dang-lei-xing-shi-shi-me" class="header-anchor">#</a></h4><p>群集是一个或多个节点(服务器)的集合，它们共同保存您的整个数据，并提供跨所有节点的联合索引 和搜索功能。群集由唯一名称标识，默认情况下为“elasticsearch”。此名称很重要，因为如果节点设置 为按名称加入群集，则该节点只能是群集的一部分。</p>
<p>节点是属于集群一部分的单个服务器。它存储数据并参与群集索引和搜索功能。 索引就像关系数据库中的“数据库”。它有一个定义多种类型的映射。索引是逻辑名称空间，映射到一个</p>
<p>或多个主分片，并且可以有零个或多个副本分片。 MySQL &#x3D;&gt;数据库 ElasticSearch &#x3D;&gt;索引</p>
<p>文档类似于关系数据库中的一行。不同之处在于索引中的每个文档可以具有不同的结构(字段)，但是 对于通用字段应该具有相同的数据类型。 MySQL &#x3D;&gt; Databases &#x3D;&gt; Tables &#x3D;&gt; Columns &#x2F; Rows ElasticSearch &#x3D;&gt; Indices &#x3D;&gt; Types &#x3D;&gt;具有属性的文档</p>
<p>类型是索引的逻辑类别&#x2F;分区，其语义完全取决于用户。</p>
<h4><span id="elasticsearch-zhi-chi-na-xie-lei-xing-de-cha-xun">Elasticsearch 支持哪些类型的查询?</span><a href="#elasticsearch-zhi-chi-na-xie-lei-xing-de-cha-xun" class="header-anchor">#</a></h4><p>查询主要分为两种类型:精确匹配、全文检索匹配。</p>
<p>精确匹配，例如 term、exists、term set、 range、prefix、 ids、 wildcard、regexp、 fuzzy 等。 全文检索，例如match、match_phrase、multi_match、match_phrase_prefix、query_string 等</p>
<h4><span id="jing-zhun-pi-pei-jian-suo-he-quan-wen-jian-suo-pi-pei-jian-suo-de-bu-tong">精准匹配检索和全文检索匹配检索的不同?</span><a href="#jing-zhun-pi-pei-jian-suo-he-quan-wen-jian-suo-pi-pei-jian-suo-de-bu-tong" class="header-anchor">#</a></h4><p>两者的本质区别:<br>  精确匹配用于:是否完全一致?<br>举例:邮编、身份证号的匹配往往是精准匹配。<br>  全文检索用于:是否相关?</p>
<h4><span id="elasticsearch-zhong-de-jie-dian-bi-ru-gong-20-ge-qi-zhong-de-10-ge-xuan-liao-yi-ge-master-ling-wai-10-ge-xuan-liao-ling-yi-ge-master-zen-me-ban">Elasticsearch 中的节点（比如共 20 个），其中的 10 个选了一个 master，另外 10 个选了另一个 master，怎么办？</span><a href="#elasticsearch-zhong-de-jie-dian-bi-ru-gong-20-ge-qi-zhong-de-10-ge-xuan-liao-yi-ge-master-ling-wai-10-ge-xuan-liao-ling-yi-ge-master-zen-me-ban" class="header-anchor">#</a></h4><p>（1）当集群 master 候选数量不小于 3 个时，可以通过设置最少投票通过数量（discovery.zen.minimum_master_nodes）超过所有候选节点一半以上来解决脑裂问题；</p>
<p>（3）当候选数量为两个时，只能修改为唯一的一个 master 候选，其他作为 data节点，避免脑裂问题。</p>
<h4><span id="elasticsearch-zhong-de-fen-pian-shi-shi-me-zai-da-duo-shu-huan-jing-zhong-mei-ge-jie-dian-du-zai-dan-du-de-he-zi-huo-xu-ni-ji-shang-yun-xing">ElasticSearch中的分片是什么? 在大多数环境中，每个节点都在单独的盒子或虚拟机上运行。</span><a href="#elasticsearch-zhong-de-fen-pian-shi-shi-me-zai-da-duo-shu-huan-jing-zhong-mei-ge-jie-dian-du-zai-dan-du-de-he-zi-huo-xu-ni-ji-shang-yun-xing" class="header-anchor">#</a></h4><p>索引 - 在Elasticsearch中，索引是文档的集合。<br> 分片 -因为Elasticsearch是一个分布式搜索引擎，所以索引通常被分割成分布在多个节点上的被称为分片 的元素。</p>
<h4><span id="qing-jie-shi-yi-xia-elasticsearch-zhong-ju-he-ju-he-you-zhu-yu-cong-sou-suo-zhong-shi-yong-de-cha-xun-zhong-shou-ji-shu-ju-ju-he-wei-ge-chong-tong-ji-zhi-biao-bian-yu-tong-ji-xin-xi-huo-zuo-qi-ta-fen-xi-ju-he">请解释一下 Elasticsearch 中聚合? 聚合有助于从搜索中使用的查询中收集数据，聚合为各种统计指标，便于统计信息或做其他分析。聚合</span><a href="#qing-jie-shi-yi-xia-elasticsearch-zhong-ju-he-ju-he-you-zhu-yu-cong-sou-suo-zhong-shi-yong-de-cha-xun-zhong-shou-ji-shu-ju-ju-he-wei-ge-chong-tong-ji-zhi-biao-bian-yu-tong-ji-xin-xi-huo-zuo-qi-ta-fen-xi-ju-he" class="header-anchor">#</a></h4><p>可帮助回答以下问题:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">我的网站平均加载时间是多少?</span><br><span class="line">根据交易量，谁是我最有价值的客户?</span><br><span class="line">什么会被视为我网络上的大文件?</span><br><span class="line">每个产品类别中有多少个产品?</span><br></pre></td></tr></table></figure>

<p>聚合的分三类:<br> 主要查看7.10 的官方文档，早期是4个分类，别大意啊!</p>
<p>分桶 Bucket 聚合 根据字段值，范围或其他条件将文档分组为桶(也称为箱)。</p>
<p>指标 Metric 聚合 从字段值计算指标(例如总和或平均值)的指标聚合。</p>
<p>管道 Pipeline 聚合 子聚合，从其他聚合(而不是文档或字段)获取输入。</p>
<h4><span id="jie-shi-yi-xia-elasticsearch-cluster">解释一下Elasticsearch Cluster?</span><a href="#jie-shi-yi-xia-elasticsearch-cluster" class="header-anchor">#</a></h4><p> Elasticsearch 集群是一组连接在一起的一个或多个 Elasticsearch 节点实例。</p>
<p>Elasticsearch 集群的功能在于在集群中的所有节点之间分配任务，进行搜索和建立索引。 10. 解释一下 Elasticsearch Node?</p>
<p>节点是 Elasticsearch 的实例。实际业务中，我们会说:ES集群包含3个节点、7个节点。 这里节点实际就是:一个独立的 Elasticsearch 进程，一般将一个节点部署到一台独立的服务器或者虚拟机、容器中。<br>不同节点根据角色不同，可以划分为:<br>  主节点<br>帮助配置和管理在整个集群中添加和删除节点。</p>
<p>数据节点 存储数据并执行诸如CRUD(创建&#x2F;读取&#x2F;更新&#x2F;删除)操作，对数据进行搜索和聚合的操作。</p>
<p>客户端节点(或者说:协调节点) 将集群请求转发到主节点，将与数据相关的请求转发到数据节点 摄取节点用于在索引之前对文档进行预处理。</p>
<h4><span id="jie-shi-yi-xia-elasticsearch-ji-qun-zhong-de-type-de-gai-nian">解释一下 Elasticsearch 集群中的 Type 的概念 ?</span><a href="#jie-shi-yi-xia-elasticsearch-ji-qun-zhong-de-type-de-gai-nian" class="header-anchor">#</a></h4><p> 5.X 以及之前的 2.X、1.X 版本 ES支持一个索引多个type的，举例 ES 6.X 中的Join 类型在早期版本实际</p>
<p>是多 Type 实现的。<br> 在6.0.0 或 更高版本中创建的索引只能包含一个 Mapping 类型。 Type 将在Elasticsearch 7.0.0中的API中弃用，并在8.0.0中完全删除。</p>
<h4><span id="ke-hu-duan-zai-he-ji-qun-lian-jie-shi-ru-he-xuan-ze-te-ding-de-jie-dian-zhi-xing-qing-qiu-de">客户端在和集群连接时，如何选择特定的节点执行请求的？</span><a href="#ke-hu-duan-zai-he-ji-qun-lian-jie-shi-ru-he-xuan-ze-te-ding-de-jie-dian-zhi-xing-qing-qiu-de" class="header-anchor">#</a></h4><p>TransportClient 利用 transport 模块远程连接一个 elasticsearch 集群。它并不加入到集群中，只是简单的获得一个或者多个初始化的 transport 地址，并以 轮询 的方式与这些地址进行通信。TransportClient 利用 transport 模块远程连接一个 elasticsearch 集群。它并不加入到集群中，只是简单的获得一个或者多个初始化的 transport 地址，并以 轮询 的方式与这些地址进行通信。</p>
<h4><span id="jie-shi-yi-xia-elasticsearch-de-fen-pian-dang-wen-dang-shu-liang-zeng-jia-ying-pan-rong-liang-he-chu-li-neng-li-bu-zu-shi-dui-ke-hu-duan-qing-qiu-de-xiang-ying-jiang-yan-chi">解释一下 Elasticsearch 的 分片? 当文档数量增加，硬盘容量和处理能力不足时，对客户端请求的响应将延迟。</span><a href="#jie-shi-yi-xia-elasticsearch-de-fen-pian-dang-wen-dang-shu-liang-zeng-jia-ying-pan-rong-liang-he-chu-li-neng-li-bu-zu-shi-dui-ke-hu-duan-qing-qiu-de-xiang-ying-jiang-yan-chi" class="header-anchor">#</a></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在这种情况下，将索引数据分成小块的过程称为分片，可改善数据搜索结果的获取。</span><br></pre></td></tr></table></figure>

<h3><span id="ding-yi-fu-ben-chuang-jian-fu-ben-de-hao-chu-shi-shi-me">定义副本、创建副本的好处是什么?</span><a href="#ding-yi-fu-ben-chuang-jian-fu-ben-de-hao-chu-shi-shi-me" class="header-anchor">#</a></h3><p> 副本是 分片的对应副本，用在极端负载条件下提高查询吞吐量或实现高可用性。</p>
<p>所谓高可用主要指:如果某主分片1出了问题，对应的副本分片1会提升为主分片，保证集群的高可用。</p>
<h4><span id="elasticsearch-analyzer-zhong-de-zi-fu-guo-lu-qi-ru-he-li-yong">Elasticsearch Analyzer 中的字符过滤器如何利用?</span><a href="#elasticsearch-analyzer-zhong-de-zi-fu-guo-lu-qi-ru-he-li-yong" class="header-anchor">#</a></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">字符过滤器将原始文本作为字符流接收，并可以通过添加，删除或更改字符来转换字符流。</span><br><span class="line">字符过滤分类如下:</span><br></pre></td></tr></table></figure>

<p>HTML Strip Character Filter. 用途:删除HTML元素，如，并解码HTML实体，如&amp;amp 。</p>
<p>Mapping Character Filter</p>
<p>用途:替换指定的字符。</p>
<p>Pattern Replace Character Filter</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用途:基于正则表达式替换指定的字符。</span><br></pre></td></tr></table></figure>

<h4><span id="rest-api-zai-elasticsearch-fang-mian-you-na-xie-you-shi">REST API在 Elasticsearch 方面有哪些优势?</span><a href="#rest-api-zai-elasticsearch-fang-mian-you-na-xie-you-shi" class="header-anchor">#</a></h4><p> REST API是使用超文本传输协议的系统之间的通信，该协议以 XML 和 JSON格式传输数据请求。</p>
<p>REST 协议是无状态的，并且与带有服务器和存储数据的用户界面分开，从而增强了用户界面与任何类型 平台的可移植性。它还提高了可伸缩性，允许独立实现组件，因此应用程序变得更加灵活。</p>
<p>REST API与平台和语言无关，只是用于数据交换的语言是XML或JSON。</p>
<p>借助:REST API 查看集群信息或者排查问题都非常方便。</p>
<h4><span id="elasticsearch-zhong-chang-yong-de-cat-ming-ling-you-na-xie">Elasticsearch 中常用的 cat命令有哪些?</span><a href="#elasticsearch-zhong-chang-yong-de-cat-ming-ling-you-na-xie" class="header-anchor">#</a></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">面试时说几个核心的就可以，包含但不限于:</span><br></pre></td></tr></table></figure>

<p>含义 命令</p>
<p>别名 GET _cat&#x2F;aliases?v 分配相关 GET _cat&#x2F;allocation<br> 计数 GET _cat&#x2F;count?v 字段数据 GET _cat&#x2F;fielddata?v 运行状况 GET_cat&#x2F;health?<br> 索引相关 GET _cat&#x2F;indices?v 主节点相关 GET _cat&#x2F;master?v 节点属性 GET _cat&#x2F;nodeattrs?v 节点 GET _cat&#x2F;nodes?v 待处理任务 GET _cat&#x2F;pending_tasks?v 插件 GET _cat&#x2F;plugins?v</p>
<p>恢复 GET _cat &#x2F; recovery?v 存储库 GET _cat &#x2F;repositories?v 段 GET _cat &#x2F;segments?v 分片 GET _cat&#x2F;shards?v<br> 快照 GET _cat&#x2F;snapshots?v 任务 GET _cat&#x2F;tasks?v<br> 模板 GET _cat&#x2F;templates?v 线程池 GET _cat&#x2F;thread_pool?v</p>
<h4><span id="ni-neng-fou-lie-chu-yu-elasticsearch-you-guan-de-zhu-yao-ke-yong-zi-duan-shu-ju-lei-xing">你能否列出与 Elasticsearch 有关的主要可用字段数据类型?</span><a href="#ni-neng-fou-lie-chu-yu-elasticsearch-you-guan-de-zhu-yao-ke-yong-zi-duan-shu-ju-lei-xing" class="header-anchor">#</a></h4><p>字符串数据类型，包括支持全文检索的 text 类型 和 精准匹配的 keyword 类型。 数值数据类型，例如字节，短整数，长整数，浮点数，双精度数，half_float，scaled_float。 日期类型，日期纳秒Date nanoseconds，布尔值，二进制(Base64编码的字符串)等。 范围(整数范围 integer_range，长范围 long_range，双精度范围 double_range，浮动范围 float_range，日期范围 date_range)。</p>
<p>包含对象的复杂数据类型，nested 、Object。 GEO 地理位置相关类型。</p>
<p>特定类型如:数组(数组中的值应具有相同的数据类型)</p>
<h4><span id="elasticsearch-liao-jie-duo-shao-shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan">Elasticsearch了解多少，说说你们公司es的集群架构，索引数据 大小，分片有多少，以及一些调优手段 。</span><a href="#elasticsearch-liao-jie-duo-shao-shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan" class="header-anchor">#</a></h4><p>如实结合自己的实践场景回答即可。 比如:ES集群架构13个节点，索引根据通道不同共20+索引，根据日期，每日递增20+，索引:10分 片，每日递增1亿+数据，<br> 每个通道每天索引大小控制:150GB之内。</p>
<p>设计阶段调优<br> 1、根据业务增量需求，采取基于日期模板创建索引，通过roll over API滚动索引; 2、使用别名进行索引管理;<br> 3、每天凌晨定时对索引做force_merge操作，以释放空间; 4、采取冷热分离机制，热数据存储到SSD，提高检索效率;冷数据定期进行shrink操作，以缩减存储; 5、采取curator进行索引的生命周期管理;<br> 6、仅针对需要分词的字段，合理的设置分词器; 7、Mapping阶段充分结合各个字段的属性，是否需要检索、是否需要存储等。……..</p>
<h5><span id="xie-ru-diao-you">写入调优</span><a href="#xie-ru-diao-you" class="header-anchor">#</a></h5><p> 1、写入前副本数设置为0; 2、写入前关闭refresh_interval设置为-1，禁用刷新机制; 3、写入过程中:采取bulk批量写入; 4、写入后恢复副本数和刷新间隔; 5、尽量使用自动生成的id。</p>
<h5><span id="cha-xun-diao-you">查询调优</span><a href="#cha-xun-diao-you" class="header-anchor">#</a></h5><p> 1、禁用wildcard; 2、禁用批量terms(成百上千的场景); 3、充分利用倒排索引机制，能keyword类型尽量keyword; 4、数据量大时候，可以先基于时间敲定索引再检索; 5、设置合理的路由机制。</p>
<p>其他调优</p>
<ul>
<li>部署调优，业务调优等。</li>
<li>上面的提及一部分，面试者就基本对你之前的实践或者运维经验有所评估了。</li>
</ul>
<h3><span id="xiang-xi-miao-shu-yi-xia-elasticsearch-sou-suo-de-guo-cheng">详细描述一下 Elasticsearch 搜索的过程？</span><a href="#xiang-xi-miao-shu-yi-xia-elasticsearch-sou-suo-de-guo-cheng" class="header-anchor">#</a></h3><p>面试官：想了解 ES 搜索的底层原理，不再只关注业务层面了。</p>
<p>解答：</p>
<p>搜索拆解为“query then fetch” 两个阶段。</p>
<p>query 阶段的目的：定位到位置，但不取。</p>
<p>步骤拆解如下：</p>
<p>（1）假设一个索引数据有 5 主+1 副本 共 10 分片，一次请求会命中（主或者副本分片中）的一个。</p>
<p>（2）每个分片在本地进行查询，结果返回到本地有序的优先队列中。</p>
<p>（3）第 2）步骤的结果发送到协调节点，协调节点产生一个全局的排序列表。</p>
<p>fetch 阶段的目的：取数据。</p>
<p>路由节点获取所有文档，返回给客户端。</p>
<h4><span id="elasticsearch-zai-bu-shu-shi-dui-linux-de-she-zhi-you-na-xie-you-hua-fang-fa">Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</span><a href="#elasticsearch-zai-bu-shu-shi-dui-linux-de-she-zhi-you-na-xie-you-hua-fang-fa" class="header-anchor">#</a></h4><p>面试官：想了解对 ES 集群的运维能力。</p>
<p>解答：</p>
<p>（1）关闭缓存 swap;</p>
<p>（2）堆内存设置为：Min（节点内存&#x2F;2, 32GB）;</p>
<p>（3）设置最大文件句柄数；</p>
<p>（4）线程池+队列大小根据业务需要做调整；</p>
<p>（5）磁盘存储 raid 方式——存储有条件使用 RAID10，增加单节点性能以及避免单节点存储故障。</p>
<h4><span id="jie-shi-yi-xia-elasticsearch-ji-qun-zhong-de-suo-yin-de-gai-nian">解释一下 Elasticsearch集群中的 索引的概念 ?</span><a href="#jie-shi-yi-xia-elasticsearch-ji-qun-zhong-de-suo-yin-de-gai-nian" class="header-anchor">#</a></h4><p>Elasticsearch 集群可以包含多个索引，与关系数据库相比，它们相当于数据库表 其他类别概念，如下表所示，点到为止。</p>
<h4><span id="lucence-nei-bu-jie-gou-shi-shi-me">lucence 内部结构是什么</span><a href="#lucence-nei-bu-jie-gou-shi-shi-me" class="header-anchor">#</a></h4><p>面试官：想了解你的知识面的广度和深度。 </p>
<p>解答： </p>
<p>Lucene 是有索引和搜索的两个过程，包含索引创建，索引，搜索三个要点。可以基于这个脉络展开一些。</p>
<h4><span id="elasticsearch-shi-ru-he-shi-xian-master-xuan-ju-de">Elasticsearch 是如何实现 Master 选举的？</span><a href="#elasticsearch-shi-ru-he-shi-xian-master-xuan-ju-de" class="header-anchor">#</a></h4><p>（1）Elasticsearch 的选主是 ZenDiscovery 模块负责的，主要包含 Ping（节点之间通过这个 RPC 来发 现彼此）和 Unicast（单播模块包含一个主机列表以控制哪些节点需要 ping 通）这两部分；</p>
<p>（2）对所有可以成为 master 的节点（node.master: true）根据 nodeId 字典排序，每次选举每个节 点都把自己所知道节点排一次序，然后选出第一个（第 0 位）节点，暂且认为它是 master 节点。</p>
<p>（3）如果对某个节点的投票数达到一定的值（可以成为 master 节点数 n&#x2F;2+1）并且该节点自己也选 举自己，那这个节点就是 master。否则重新选举一直到满足上述条件。</p>
<p>（4）补充：master 节点的职责主要包括集群、节点和索引的管理，不负责文档级别的管理；data 节点可以关闭 http 功能</p>
<h4><span id="elasticsearch-suo-yin-shu-ju-duo-liao-zen-me-ban-ru-he-diao-you-bu-shu">Elasticsearch 索引数据多了怎么办，如何调优，部署</span><a href="#elasticsearch-suo-yin-shu-ju-duo-liao-zen-me-ban-ru-he-diao-you-bu-shu" class="header-anchor">#</a></h4><p>索引数据的规划，应在前期做好规划，正所谓“设计先行，编码在后”，这样才能有效的避免突如其来的 数据激增导致集群处理能力不足引发的线上客户检索或者其他业务受到影响。 如何调优，正如问题1所说，这里细化一下:</p>
<p>动态索引层面<br> 基于 创建索引，举例:设计阶段定义:blog索引的模板格式为:</p>
<p>blog_index_时间戳的形式，每天递增数据。 这样做的好处:不至于数据量激增导致单个索引数据量非常大，接近于上线2的32次幂-1，索引存储达到</p>
<p>了TB+甚至更大。 一旦单个索引很大，存储等各种风险也随之而来，所以要提前考虑+及早避免。</p>
<p>存储层面</p>
<p>，热数据(比如最近3天或者一周的数据)，其余为冷数据。 对于冷数据不会再写入新数据，可以考虑定期force_merge加shrink压缩操作，节省存储空间和检索效 率。</p>
<p>部署层面</p>
<p>一旦之前没有规划，这里就属于应急策略。 结合ES自身的支持动态扩展的特点，动态新增机器的方式可以缓解集群压力，注意:如果之前主节点 ，不需要重启集群也能完成动态新增的。</p>
<ol start="21">
<li>我们可以在 Elasticsearch 中执行搜索的各种可能方式有哪些? 方式一:</li>
</ol>
<p>基于 DSL 检索(最常用) Elasticsearch提供基于JSON的完整查询DSL来定义查询。</p>
<p>方式二:</p>
<p>}} “iccug” :”dnarb” { :”mret” { ,}} “der” :”roloc” { :”mret” {</p>
<p>[ :”retlif”<br> { :”loob”</p>
<p>动滚ipa revollor+间时+板模</p>
<p>} ]</p>
<p>{ :”yreuq”<br> {</p>
<p>hcraes_&#x2F;strihs&#x2F; TEG</p>
<p>储存离分据数热冷</p>
<p>} }</p>
<p>理合划规</p>
<p>基于 URL 检索</p>
<p>方式三: 类SQL 检索</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">功能还不完备，不推荐使用。</span><br></pre></td></tr></table></figure>

<h4><span id="zai-elasticsearch-zhong-shan-chu-suo-yin-de-yu-fa-shi-shi-me-ke-yi-shi-yong-yi-xia-yu-fa-shan-chu-xian-you-suo-yin">在 Elasticsearch 中删除索引的语法是什么? 可以使用以下语法删除现有索引:</span><a href="#zai-elasticsearch-zhong-shan-chu-suo-yin-de-yu-fa-shi-shi-me-ke-yi-shi-yong-yi-xia-yu-fa-shan-chu-xian-you-suo-yin" class="header-anchor">#</a></h4><p>支持通配符删除:</p>
<h4><span id="zai-elasticsearch-zhong-lie-chu-ji-qun-de-suo-you-suo-yin-de-yu-fa-shi-shi-me">在 Elasticsearch 中列出集群的所有索引的语法是什么?</span><a href="#zai-elasticsearch-zhong-lie-chu-ji-qun-de-suo-you-suo-yin-de-yu-fa-shi-shi-me" class="header-anchor">#</a></h4><h4><span id="zai-suo-yin-zhong-geng-xin-mapping-de-yu-fa">在索引中更新 Mapping 的语法?</span><a href="#zai-suo-yin-zhong-geng-xin-mapping-de-yu-fa" class="header-anchor">#</a></h4><p>} “5 TIMIL CSED dimeti YB REDRO 71-80-0202-tniu MORF * TCELES” :”yreuq”</p>
<p>} “drowyek”:”epyt”</p>
<p>{:”eltit”<br> { :”seitreporp”</p>
<p>{ gnippam_&#x2F;100_tset TUP</p>
<p>secidni&#x2F;tac_ TEG</p>
<p>*_ym ETELED</p>
<p>&gt;eman_xedni&lt; ETELED</p>
<p>{ txt&#x3D;tamrof?lqs_&#x2F; TSOP</p>
<p>anies:resu&#x3D;q?hcraes_&#x2F;xedni_ym&#x2F; TEG</p>
<p>} }</p>
<h4><span id="es-xie-shu-ju-guo-cheng">ES 写数据过程</span><a href="#es-xie-shu-ju-guo-cheng" class="header-anchor">#</a></h4><p>客户端选择一个 node 发送请求过去，这个 node 就是 (协调节点)。 对 document 进行路由，将请求转发给对应的 node(有 primaryshard)。[路由的算法是?] 实际的 node 上的如果发现应结果给客户端。处理请求，然后将数据同步到和所有。 都搞定之后，就返回响</p>
<h4><span id="es-du-shu-ju-guo-cheng-ke-yi-tong-guo-lai-cha-xun-hui-gen-ju">ES 读数据过程 可以通过 来查询，会根据</span><a href="#es-du-shu-ju-guo-cheng-ke-yi-tong-guo-lai-cha-xun-hui-gen-ju" class="header-anchor">#</a></h4><p>shard 上面去，从那个 shard 去查询。</p>
<p>进行 hash，判断出来当时把</p>
<p>分配到了哪个</p>
<p>客户端发送请求到任意一个 node，成为 。<br> 对 进行哈希路由，将请求转发到对应的 node，此时会使用</p>
<p>随机轮询算法，在衡。<br> 接收请求的 node 返回 document 给</p>
<p>以及其所有 replica 中随机选择一个，让读请求负载均 。</p>
<p>返回 document 给客户端。<br> primary shard replica shard primary shard</p>
<p>replica shard</p>
<ol start="27">
<li>底层 lucene<br> 简单来说，lucene 就是一个 jar 包，里面包含了封装好的各种建立倒排索引的算法代码。我们用 Java</li>
</ol>
<p>开发的时候，引入 lucene jar，然后基于 lucene 的 api 去开发就可以了。</p>
<p>通过 lucene，我们可以将已有的数据建立索引，lucene 会在本地磁盘上面，给我们组织索引的数据结 构。</p>
<p>。法算询轮机随是的用采，取读 或从以可求请读;的有所给步同后然，入写是求请写</p>
<p>dnuor</p>
<p>edon etanidrooc</p>
<p>di cod</p>
<p>di cod</p>
<p>di cod</p>
<p>edon acilper edon acilper</p>
<p>edon gnitanidrooc</p>
<p>edon gnitanidrooc</p>
<p>edon etanidrooc</p>
<p>edon etanidrooc</p>
<p>drahs yramirp di cod</p>
<p>nibor</p>
<p>edon yramirp<br> drahs yramirp</p>
<p>edon etanidrooc</p>
<p>edon gnitanidrooc</p>
<h4><span id="es-zhong-de-dao-pai-suo-yin-shi-shi-me">ES中的倒排索引是什么?</span><a href="#es-zhong-de-dao-pai-suo-yin-shi-shi-me" class="header-anchor">#</a></h4><p>传统的检索方式是通过文章，逐个遍历找到对应关键词的位置。 倒排索引，是通过分词策略，形成了词和文章的映射关系表，也称倒排表，这种词典 + 映射表即为倒排 索引。</p>
<p>其中词典中存储词元，倒排表中存储该词元在哪些文中出现的位置。 有了倒排索引，就能实现 O(1) 时间复杂度的效率检索文章了，极大的提高了检索效率。</p>
<p>加分项:<br> 倒排索引的底层实现是基于:FST(Finite State Transducer)数据结构。</p>
<p>Lucene 从 4+ 版本后开始大量使用的数据结构是 FST。FST 有两个优点: 1、空间占用小。通过对词典中单词前缀和后缀的重复利用，压缩了存储空间; 2、查询速度快。O(len(str)) 的查询时间复杂度。</p>
<h4><span id="qing-jie-shi-zai-elasticsearch-ji-qun-zhong-tian-jia-huo-chuang-jian-suo-yin-de-guo-cheng-yao-tian-jia-xin-suo-yin-ying-shi-yong-chuang-jian-suo-yin-api-xuan-xiang-chuang-jian-suo-yin-suo-xu-de-can-shu-shi-suo-yin-de-pei-zhi-settings-suo-yin-zhong-de-zi-duan">请解释在 Elasticsearch 集群中添加或创建索引的过程? 要添加新索引，应使用创建索引 API 选项。创建索引所需的参数是索引的配置Settings，索引中的字段</span><a href="#qing-jie-shi-zai-elasticsearch-ji-qun-zhong-tian-jia-huo-chuang-jian-suo-yin-de-guo-cheng-yao-tian-jia-xin-suo-yin-ying-shi-yong-chuang-jian-suo-yin-api-xuan-xiang-chuang-jian-suo-yin-suo-xu-de-can-shu-shi-suo-yin-de-pei-zhi-settings-suo-yin-zhong-de-zi-duan" class="header-anchor">#</a></h4><p>Mapping 以及索引别名 Alias。 也可以通过模板 Template 创建索引。</p>
<h4><span id="xiang-xi-miao-shu-yi-xia-elasticsearch-suo-yin-wen-dang-de-guo-cheng">详细描述一下Elasticsearch索引文档的过程。</span><a href="#xiang-xi-miao-shu-yi-xia-elasticsearch-suo-yin-wen-dang-de-guo-cheng" class="header-anchor">#</a></h4><p>协调节点默认使用文档ID参与计算(也支持通过routing)，以便为路由提供合适的分片。</p>
<p>shard &#x3D; hash(document_id) % (num_of_primary_shards)</p>
<p>当分片所在的节点接收到来自协调节点的请求后，会将请求写入到Memory Buffer，然后定时(默认是 每隔1秒)写入到Filesystem Cache，这个从Momery Buffer到Filesystem Cache的过程就叫做 refresh;</p>
<p>当然在某些情况下，存在Momery Buffer和Filesystem Cache的数据可能会丢失，ES是通过translog 的机制来保证数据的可靠性的。其实现机制是接收到请求后，同时也会写入到translog中，当 Filesystem cache中的数据写入到磁盘中时，才会清除掉，这个过程叫做flush;</p>
<p>在flush过程中，内存中的缓冲将被清除，内容被写入一个新段，段的fsync将创建一个新的提交点，并 将内容刷新到磁盘，旧的translog将被删除并开始一个新的translog。</p>
<p>flush触发的时机是定时触发(默认30分钟)或者translog变得太大(默认为512M)时; 31. 详细描述一下Elasticsearch更新和删除文档的过程</p>
<p>删除和更新也都是写操作，但是Elasticsearch中的文档是不可变的，因此不能被删除或者改动以展示其 变更;</p>
<p>磁盘上的每个段都有一个相应的.del文件。当删除请求发送后，文档并没有真的被删除，而是在.del文 件中被标记为删除。该文档依然能匹配查询，但是会在结果中被过滤掉。当段合并时，在.del文件中被 标记为删除的文档将不会被写入新段。</p>
<p>在新的文档被创建时，Elasticsearch会为该文档指定一个版本号，当执行更新时，旧版本的文档在.del 文件中被标记为删除，新版本的文档被索引到一个新段。旧版本的文档依然能匹配查询，但是会在结果 中被过滤掉。</p>
<h4><span id="xiang-xi-miao-shu-yi-xia-elasticsearch-sou-suo-de-guo-cheng-sou-suo-bei-zhi-xing-cheng-yi-ge-liang-jie-duan-guo-cheng-wo-men-cheng-zhi-wei-query-then-fetch">详细描述一下Elasticsearch搜索的过程 搜索被执行成一个两阶段过程，我们称之为 Query Then Fetch;</span><a href="#xiang-xi-miao-shu-yi-xia-elasticsearch-sou-suo-de-guo-cheng-sou-suo-bei-zhi-xing-cheng-yi-ge-liang-jie-duan-guo-cheng-wo-men-cheng-zhi-wei-query-then-fetch" class="header-anchor">#</a></h4><p>在初始查询阶段时，查询会广播到索引中每一个分片拷贝(主分片或者副本分片)。 每个分片在本地执 行搜索并构建一个匹配文档的大小为 from + size 的优先队列。PS:在搜索的时候是会查询Filesystem Cache的，但是有部分数据还在Memory Buffer，所以搜索是近实时的。</p>
<p>每个分片返回各自优先队列中 所有文档的 ID 和排序值 给协调节点，它合并这些值到自己的优先队列中 来产生一个全局排序后的结果列表。</p>
<p>接下来就是 取回阶段，协调节点辨别出哪些文档需要被取回并向相关的分片提交多个 GET 请求。每个 分片加载并 丰富 文档，如果有需要的话，接着返回文档给协调节点。一旦所有的文档都被取回了，协调 节点返回结果给客户端。</p>
<p>补充:Query Then Fetch的搜索类型在文档相关性打分的时候参考的是本分片的数据，这样在文档数 量较少的时候可能不够准确，DFS Query Then Fetch增加了一个预查询的处理，询问Term和 Document frequency，这个评分更准确，但是性能会变差。</p>
<h4><span id="elasticsearch-dui-yu-da-shu-ju-liang-shang-yi-liang-ji-de-ju-he-ru-he-shi-xian">Elasticsearch对于大数据量(上亿量级)的聚合如何实现?</span><a href="#elasticsearch-dui-yu-da-shu-ju-liang-shang-yi-liang-ji-de-ju-he-ru-he-shi-xian" class="header-anchor">#</a></h4><p>Elasticsearch 提供的首个近似聚合是cardinality 度量。它提供一个字段的基数，即该字段的distinct 或者unique值的数目。它是基于HLL算法的。HLL 会先对我们的输入作哈希运算，然后根据哈希运算的 结果中的 bits 做概率估算从而得到基数。其特点是:可配置的精度，用来控制内存的使用(更精确 &#x3D; 更多内存);小的数据集精度是非常高的;我们可以通过配置参数，来设置去重需要的固定内存使用 量。无论数千还是数十亿的唯一值，内存使用量只与你配置的精确度相关 .</p>
<h4><span id="ni-ke-yi-lie-chu-elasticsearch-ge-chong-lei-xing-de-fen-xi-qi-ma">你可以列出 Elasticsearch 各种类型的分析器吗?</span><a href="#ni-ke-yi-lie-chu-elasticsearch-ge-chong-lei-xing-de-fen-xi-qi-ma" class="header-anchor">#</a></h4><p>Elasticsearch Analyzer 的类型为内置分析器和自定义分析器。 Standard Analyzer</p>
<p>标准分析器是默认分词器，如果未指定，则使用该分词器。 它基于Unicode文本分割算法，适用于大多数语言。</p>
<p>Whitespace Analyzer</p>
<p>基于空格字符切词。</p>
<p>Stop Analyzer<br> 在simple Analyzer的基础上，移除停用词。</p>
<p>Keyword Analyzer</p>
<p>不切词，将输入的整个串一起返回。 自定义分词器的模板 自定义分词器的在Mapping的Setting部分设置:</p>
<p>脑海中还是上面的三部分组成的图示。其中: “char_filter”:{},——对应字符过滤部分; “tokenizer”:{},——对应文本切分为分词部分; “filter”:{},——对应分词后再过滤部分; “analyzer”:{}——对应分词器组成部分，其中会包含:1. 2. 3。</p>
<h4><span id="es-shi-ru-he-shi-xian-master-xuan-ju-de">ES是如何实现master选举的?</span><a href="#es-shi-ru-he-shi-xian-master-xuan-ju-de" class="header-anchor">#</a></h4><p>前置条件: 1、只有是候选主节点(master:true)的节点才能成为主节点。 2、最小主节点数(min_master_nodes)的目的是防止脑裂。</p>
<p>Elasticsearch 的选主是 ZenDiscovery 模块负责的，主要包含 Ping(节点之间通过这个RPC来发现彼 此)和 Unicast(单播模块包含一个主机列表以控制哪些节点需要 ping 通)这两部分; 获取主节点的核心入口为 findMaster，选择主节点成功返回对应 Master，否则返回 null。</p>
<p>选举流程大致描述如下:<br> 第一步:确认候选主节点数达标，elasticsearch.yml 设置的值 discovery.zen.minimum_master_nodes; </p>
<p>第二步:对所有候选主节点根据nodeId字典排序，每次选举每个节点都把自己所知道节点排一次序，然 后选出第一个(第0位)节点，暂且认为它是master节点。 </p>
<p>第三步:如果对某个节点的投票数达到一定的值(候选主节点数n&#x2F;2+1)并且该节点自己也选举自己， 那这个节点就是master。否则重新选举一直到满足上述条件。</p>
<p>补充:</p>
<ul>
<li>这里的 id 为 string 类型。</li>
<li>master 节点的职责主要包括集群、节点和索引的管理，不负责文档级别的管理;data 节点 可以关闭 http 功能。</li>
</ul>
<h4><span id="master-jie-dian-he-hou-xuan-master-jie-dian-you-shi-me-qu-bie-zhu-jie-dian-fu-ze-ji-qun-xiang-guan-de-cao-zuo-li-ru-chuang-jian-huo-shan-chu-suo-yin-gen-zong-na-xie-jie-dian-shi-ji-qun-de-yi-bu-fen-yi-ji-jue-ding-jiang-na-xie-fen-pian-fen-pei-gei-na-xie-jie-dian">Master 节点和 候选 Master节点有什么区别? 主节点负责集群相关的操作，例如创建或删除索引，跟踪哪些节点是集群的一部分，以及决定将哪些分片分配给哪些节点。</span><a href="#master-jie-dian-he-hou-xuan-master-jie-dian-you-shi-me-qu-bie-zhu-jie-dian-fu-ze-ji-qun-xiang-guan-de-cao-zuo-li-ru-chuang-jian-huo-shan-chu-suo-yin-gen-zong-na-xie-jie-dian-shi-ji-qun-de-yi-bu-fen-yi-ji-jue-ding-jiang-na-xie-fen-pian-fen-pei-gei-na-xie-jie-dian" class="header-anchor">#</a></h4><p>拥有稳定的主节点是衡量集群健康的重要标志。而候选主节点是被选具备候选资格，可以被选为主节点的那些节点。</p>
<h4><span id="elasticsearch-zhong-de-shu-xing-enabled-index-he-store-de-gong-neng-shi-shi-me">Elasticsearch中的属性 enabled, index 和 store 的功能是什 么?</span><a href="#elasticsearch-zhong-de-shu-xing-enabled-index-he-store-de-gong-neng-shi-shi-me" class="header-anchor">#</a></h4><p>enabled:false，启用的设置仅可应用于顶级映射定义和 Object 对象字段，导致 Elasticsearch 完全跳过对字段内容的解析。</p>
<p>仍然可以从_source字段中检索JSON，但是无法搜索或以其他任何方式存储JSON。 如果对非全局或者 Object 类型，设置 enable : false 会报错如下:</p>
<p>index:false, 索引选项控制是否对字段值建立索引。它接受true或false，默认为true。未索引 的字段不可查询。</p>
<p>如果非要检索，报错如下:</p>
<p>store: 某些特殊场景下，如果你只想检索单个字段或几个字段的值，而不是整个_source的值，则可以使</p>
<p>用源过滤来实现;这个时候， store 就派上用场了。</p>
<h4><span id="elasticsearch-zhong-de-jie-dian-bi-ru-gong-20-ge-qi-zhong-de-10-ge-xuan-liao-yi-ge-master-ling-wai-10-ge-xuan-liao-ling-yi-ge-master-zen-me-ban">Elasticsearch中的节点(比如共20个)，其中的10个选了一个 master，另外10个选了另一个master，怎么办?</span><a href="#elasticsearch-zhong-de-jie-dian-bi-ru-gong-20-ge-qi-zhong-de-10-ge-xuan-liao-yi-ge-master-ling-wai-10-ge-xuan-liao-ling-yi-ge-master-zen-me-ban" class="header-anchor">#</a></h4><p>当集群master候选数量不小于3个时，可以通过设置最少投票通过数量 (discovery.zen.minimum_master_nodes)超过所有候选节点一半以上来解决脑裂问题; 当候选数量为两个时，只能修改为唯一的一个master候选，其他作为data节点，避免脑裂问题。</p>
<h4><span id="ru-he-jie-jue-es-ji-qun-de-nao-lie-wen-ti">如何解决ES集群的脑裂问题</span><a href="#ru-he-jie-jue-es-ji-qun-de-nao-lie-wen-ti" class="header-anchor">#</a></h4><p> 所谓集群脑裂，是指 Elasticsearch 集群中的节点(比如共 20 个)，其中的 10 个选了一个 master，</p>
<p>另外 10 个选了另一个 master 的情况。</p>
<p>当集群 master 候选数量不小于 3 个时，可以通过设置最少投票通过数量 (discovery.zen.minimum_master_nodes)超过所有候选节点一半以上来解决脑裂问题; 当候选数量为两个时，只能修改为唯一的一个 master 候选，其他作为 data 节点，避免脑裂问题。</p>
<h4><span id="xiang-xi-miao-shu-yi-xia-es-suo-yin-wen-dang-de-guo-cheng">详细描述一下ES索引文档的过程?</span><a href="#xiang-xi-miao-shu-yi-xia-es-suo-yin-wen-dang-de-guo-cheng" class="header-anchor">#</a></h4><p>这里的索引文档应该理解为文档写入 ES，创建索引的过程。 第一步:</p>
<p>客户端向集群某节点写入数据，发送请求。(如果没有指定路由&#x2F;协调节点，请求的节点扮演协调节点的 角色。)</p>
<p>第二步:</p>
<p>协调节点接受到请求后，默认使用文档 ID 参与计算(也支持通过 routing)，得到该文档属于哪个分 片。随后请求会被转到另外的节点。</p>
<p>第三步:</p>
<p>当分片所在的节点接收到来自协调节点的请求后，会将请求写入到 Memory Buffer，然后定时(默认 是每隔 1 秒)写入到F ilesystem Cache，这个从 Momery Buffer 到 Filesystem Cache 的过程就叫 做 refresh;</p>
<p>第四步:</p>
<p>当然在某些情况下，存在 Memery Buffer 和 Filesystem Cache 的数据可能会丢失，ES 是通过 translog 的机制来保证数据的可靠性的。其实现机制是接收到请求后，同时也会写入到 translog 中， 当 Filesystem cache 中的数据写入到磁盘中时，才会清除掉，这个过程叫做 flush;</p>
<p>第五步:<br> 在 flush 过程中，内存中的缓冲将被清除，内容被写入一个新段，段的 fsync 将创建一个新的提交点，</p>
<p>并将内容刷新到磁盘，旧的 translog 将被删除并开始一个新的 translog。</p>
<p> 第六步:</p>
<p> 触发的时机是定时触发(默认 30 分钟)或者 translog 变得太大(默认为 512 M)时。</p>
<p>补充:关于 Lucene 的 Segement</p>
<blockquote>
<p>Lucene 索引是由多个段组成，段本身是一个功能齐全的倒排索引。<br>段是不可变的，允许 Lucene 将新的文档增量地添加到索引中，而不用从头重建索引。 对于每一个搜索请求而言，索引中的所有段都会被搜索，并且每个段会消耗 CPU 的时钟周、 文件句柄和内存。这意味着段的数量越多，搜索性能会越低。 为了解决这个问题，Elasticsearch 会合并小段到一个较大的段，提交新的合并段到磁盘，并 删除那些旧的小段。(段合并)</p>
</blockquote>
<h4><span id="xiang-xi-miao-shu-yi-xia-es-geng-xin-he-shan-chu-wen-dang-de-guo-cheng">详细描述一下ES更新和删除文档的过程?</span><a href="#xiang-xi-miao-shu-yi-xia-es-geng-xin-he-shan-chu-wen-dang-de-guo-cheng" class="header-anchor">#</a></h4><p> 删除和更新也都是写操作，但是 Elasticsearch 中的文档是不可变的，因此不能被删除或者改动以展示其变更。</p>
<p>磁盘上的每个段都有一个相应的 .del 文件。当删除请求发送后，文档并没有真的被删除，而是在 .del 文件中被标记为删除。该文档依然能匹配查询，但是会在结果中被过滤掉。当段合并时，在 .del 文件中 被标记为删除的文档将不会被写入新段。</p>
<p>在新的文档被创建时，Elasticsearch 会为该文档指定一个版本号，当执行更新时，旧版本的文档在 .del 文件中被标记为删除，新版本的文档被索引到一个新段。旧版本的文档依然能匹配查询，但是会在 结果中被过滤掉。</p>
<h4><span id="xiang-xi-miao-shu-yi-xia-es-sou-suo-de-guo-cheng">详细描述一下ES搜索的过程?</span><a href="#xiang-xi-miao-shu-yi-xia-es-sou-suo-de-guo-cheng" class="header-anchor">#</a></h4><p>搜索被执行成一个两阶段过程，即 Query Then Fetch;<br> Query阶段: 查询会广播到索引中每一个分片拷贝(主分片或者副本分片)。每个分片在本地执行搜索并构建一个匹 配文档的大小为 from + size 的优先队列。PS:在搜索的时候是会查询Filesystem Cache的，但是有 部分数据还在Memory Buffer，所以搜索是近实时的。</p>
<p>每个分片返回各自优先队列中 所有文档的 ID 和排序值 给协调节点，它合并这些值到自己的优先队列中 来产生一个全局排序后的结果列表。<br> Fetch阶段:<br> 协调节点辨别出哪些文档需要被取回并向相关的分片提交多个 GET 请求。每个分片加载并 丰富 文档， 如果有需要的话，接着返回文档给协调节点。一旦所有的文档都被取回了，协调节点返回结果给客户 端。</p>
<h4><span id="zai-bing-fa-qing-kuang-xia-es-ru-guo-bao-zheng-du-xie-yi-zhi">在并发情况下，ES如果保证读写一致?</span><a href="#zai-bing-fa-qing-kuang-xia-es-ru-guo-bao-zheng-du-xie-yi-zhi" class="header-anchor">#</a></h4><p>可以通过版本号使用乐观并发控制，以确保新版本不会被旧版本覆盖，由应用层来处理具体的冲突; 另外对于写操作，一致性级别支持quorum&#x2F;one&#x2F;all，默认为quorum，即只有当大多数分片可用时才 允许写操作。但即使大多数可用，也可能存在因为网络等原因导致写入副本失败，这样该副本被认为故 障，分片将会在一个不同的节点上重建。 对于读操作，可以设置replication为sync(默认)，这使得操作在主分片和副本分片都完成后才会返回; 如果设置replication为async时，也可以通过设置搜索请求参数_preference为primary来查询主分 片，确保文档是最新版本。</p>
<h4><span id="es-dui-yu-da-shu-ju-liang-shang-yi-liang-ji-de-ju-he-ru-he-shi-xian">ES对于大数据量(上亿量级)的聚合如何实现?</span><a href="#es-dui-yu-da-shu-ju-liang-shang-yi-liang-ji-de-ju-he-ru-he-shi-xian" class="header-anchor">#</a></h4><p>Elasticsearch 提供的首个近似聚合是cardinality 度量。它提供一个字段的基数，即该字段的distinct 或者unique值的数目。它是基于HLL算法的。HLL 会先对我们的输入作哈希运算，然后根据哈希运算的 结果中的 bits 做概率估算从而得到基数。其特点是:可配置的精度，用来控制内存的使用(更精确 &#x3D; 更多内存);小的数据集精度是非常高的;我们可以通过配置参数，来设置去重需要的固定内存使用 量。无论数千还是数十亿的唯一值，内存使用量只与你配置的精确度相关。</p>
<h4><span id="dui-yu-gc-fang-mian-zai-shi-yong-es-shi-yao-zhu-yi-shi-me">对于GC方面，在使用ES时要注意什么?</span><a href="#dui-yu-gc-fang-mian-zai-shi-yong-es-shi-yao-zhu-yi-shi-me" class="header-anchor">#</a></h4><p>1)倒排词典的索引需要常驻内存，无法GC，需要监控data node上segment memory增长趋势。</p>
<p> 2)各类缓存，field cache, filter cache, indexing cache, bulk queue等等，要设置合理的大小，并 且要应该根据最坏的情况来看heap是否够用，也就是各类缓存全部占满的时候，还有heap空间可以分 配给其他任务吗?避免采用clear cache等“自欺欺人”的方式来释放内存。 </p>
<p>3)避免返回大量结果集的搜索与聚合。确实需要大量拉取数据的场景，可以采用scan &amp; scroll api来实 现。</p>
<p>4)cluster stats驻留内存并无法水平扩展，超大规模集群可以考虑分拆成多个集群通过tribe node连 接。<br> 5)想知道heap够不够，必须结合实际应用场景，并对集群的heap使用情况做持续的监控。</p>
<h4><span id="shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan">说说你们公司ES的集群架构，索引数据大小，分片有多少，以及 一些调优手段?</span><a href="#shuo-shuo-ni-men-gong-si-es-de-ji-qun-jia-gou-suo-yin-shu-ju-da-xiao-fen-pian-you-duo-shao-yi-ji-yi-xie-diao-you-shou-duan" class="header-anchor">#</a></h4><p>根据实际情况回答即可，如果是我的话会这么回答: 我司有多个ES集群，下面列举其中一个。该集群有20个节点，根据数据类型和日期分库，每个索引根据 数据量分片，比如日均1亿+数据的，控制单索引大小在200GB以内。 下面重点列举一些调优策略，仅是我做过的，不一定全面，如有其它建议或者补充欢迎留言。 部署层面: </p>
<p>​			1)最好是64GB内存的物理机器，但实际上32GB和16GB机器用的比较多，但绝对不能少于8G，除非数 据量特别少，这点需要和客户方面沟通并合理说服对方。</p>
<p>​			 2)多个内核提供的额外并发远胜过稍微快一点点的时钟频率。</p>
<p>​			 3)尽量使用SSD，因为查询和索引性能将会得到显著提升。</p>
<p>​			 4)避免集群跨越大的地理距离，一般一个集群的所有节点位于一个数据中心中。 </p>
<p>​			5)设置堆内存:节点内存&#x2F;2，不要超过32GB。一般来说设置export ES_HEAP_SIZE&#x3D;32g环境变量，比 直接写-Xmx32g -Xms32g更好一点。 </p>
<p>​			6)关闭缓存swap。内存交换到磁盘对服务器性能来说是致命的。如果内存交换到磁盘上，一个100微 秒的操作可能变成10毫秒。 再想想那么多10微秒的操作时延累加起来。不难看出swapping对于性能是 多么可怕。</p>
<p>​			 7)增加文件描述符，设置一个很大的值，如65535。Lucene使用了大量的文件，同时，Elasticsearch 在节点和HTTP客户端之间进行通信也使用了大量的套接字。所有这一切都需要足够的文件描述符。 </p>
<p>​				8)不要随意修改垃圾回收器(CMS)和各个线程池的大小。 </p>
<p>​				9)通过设置gateway.recover_after_nodes、gateway.expected_nodes、 gateway.recover_after_time可以在集群重启的时候避免过多的分片交换，这可能会让数据恢复从数 个小时缩短为几秒钟。</p>
<p>索引层面:<br> 1)使用批量请求并调整其大小:每次批量数据 5–15 MB 大是个不错的起始点。 </p>
<p>2)段合并:Elasticsearch默认值是20MB&#x2F;s，对机械磁盘应该是个不错的设置。如果你用的是SSD，可 以考虑提高到100-200MB&#x2F;s。如果你在做批量导入，完全不在意搜索，你可以彻底关掉合并限流。另外 还可以增加 index.translog.flush_threshold_size 设置，从默认的512MB到更大一些的值，比如 1GB，这可以在一次清空触发的时候在事务日志里积累出更大的段。</p>
<p> 3)如果你的搜索结果不需要近实时的准确度，考虑把每个索引的index.refresh_interval 改到30s。</p>
<p> 4)如果你在做大批量导入，考虑通过设置index.number_of_replicas: 0 关闭副本。 </p>
<p>5)需要大量拉取数据的场景，可以采用scan &amp; scroll api来实现，而不是from&#x2F;size一个大范围。 存储层面: </p>
<p>​			1)基于数据+时间滚动创建索引，每天递增数据。控制单个索引的量，一旦单个索引很大，存储等各种 风险也随之而来，所以要提前考虑+及早避免。</p>
<p>​			 2)冷热数据分离存储，热数据(比如最近3天或者一周的数据)，其余为冷数据。对于冷数据不会再写 入新数据，可以考虑定期force_merge加shrink压缩操作，节省存储空间和检索效率</p>
<h4><span id="zai-bing-fa-qing-kuang-xia-elasticsearch-ru-guo-bao-zheng-du-xie-yi-zhi-ke-yi-tong-guo-ban-ben-hao-shi-yong-le-guan-bing-fa-kong-zhi-yi-que-bao-xin-ban-ben-bu-hui-bei-jiu-ban-ben-fu-gai-you-ying-yong-ceng-lai-chu-li-ju-ti-de-chong-tu">在并发情况下，Elasticsearch如果保证读写一致? 可以通过版本号使用乐观并发控制，以确保新版本不会被旧版本覆盖，由应用层来处理具体的冲突;</span><a href="#zai-bing-fa-qing-kuang-xia-elasticsearch-ru-guo-bao-zheng-du-xie-yi-zhi-ke-yi-tong-guo-ban-ben-hao-shi-yong-le-guan-bing-fa-kong-zhi-yi-que-bao-xin-ban-ben-bu-hui-bei-jiu-ban-ben-fu-gai-you-ying-yong-ceng-lai-chu-li-ju-ti-de-chong-tu" class="header-anchor">#</a></h4><p>另外对于写操作，一致性级别支持quorum&#x2F;one&#x2F;all，默认为quorum，即只有当大多数分片可用时才 允许写操作。但即使大多数可用，也可能存在因为网络等原因导致写入副本失败，这样该副本被认为故障，分片将会在一个不同的节点上重建。</p>
<p>对于读操作，可以设置replication为sync(默认)，这使得操作在主分片和副本分片都完成后才会返回; 如果设置replication为async时，也可以通过设置搜索请求参数_preference为primary来查询主分 片，确保文档是最新版本。</p>

    </div>

    
    
    <div class="post-widgets">
      <div id="needsharebutton-postbottom">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    </div>
        <div class="reward-container">
  <div>坚持原创技术分享，您的支持将鼓励我继续创作！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Java面试题
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://javamianshi.vercel.app/posts/21376.html" title="elasticsearch面试题">https://javamianshi.vercel.app/posts/21376.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
<div class="wechat_channel">
  <br>
  <!-- 这里添加你的二维码图片 -->
  <!-- <img src ="/images/qq3.png"> -->
</div>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/elasticsearch%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag"># elasticsearch面试题</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/39055.html" rel="prev" title="MQ RabbitMq面试题">
      <i class="fa fa-chevron-left"></i> MQ RabbitMq面试题
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/52041.html" rel="next" title="text3">
      text3 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">elasticsearch 了解多少，说说你们公司 es 的集群架构，索引数据大小，分片有多少，以及一些调优手段 。</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.1.</span> <span class="nav-text">设计阶段调优</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.2.</span> <span class="nav-text">写入调优</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.3.</span> <span class="nav-text">查询调优</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.4.</span> <span class="nav-text">其他调优</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.5.</span> <span class="nav-text">简要介绍一下Elasticsearch?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.6.</span> <span class="nav-text">安装 Elasticsearch 需要依赖什么组件吗?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.7.</span> <span class="nav-text">如何启动 Elasticsearch 服务器? 启动方式有很多种，一般 bin 路径下</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.8.</span> <span class="nav-text">ElasticSearch中的集群、节点、索引、文档、类型是什么?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.9.</span> <span class="nav-text">Elasticsearch 支持哪些类型的查询?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.10.</span> <span class="nav-text">精准匹配检索和全文检索匹配检索的不同?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.11.</span> <span class="nav-text">Elasticsearch 中的节点（比如共 20 个），其中的 10 个选了一个 master，另外 10 个选了另一个 master，怎么办？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.12.</span> <span class="nav-text">ElasticSearch中的分片是什么? 在大多数环境中，每个节点都在单独的盒子或虚拟机上运行。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.13.</span> <span class="nav-text">请解释一下 Elasticsearch 中聚合? 聚合有助于从搜索中使用的查询中收集数据，聚合为各种统计指标，便于统计信息或做其他分析。聚合</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.14.</span> <span class="nav-text">解释一下Elasticsearch Cluster?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.15.</span> <span class="nav-text">解释一下 Elasticsearch 集群中的 Type 的概念 ?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.16.</span> <span class="nav-text">客户端在和集群连接时，如何选择特定的节点执行请求的？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.0.17.</span> <span class="nav-text">解释一下 Elasticsearch 的 分片? 当文档数量增加，硬盘容量和处理能力不足时，对客户端请求的响应将延迟。</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.1.</span> <span class="nav-text">定义副本、创建副本的好处是什么?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.1.1.</span> <span class="nav-text">Elasticsearch Analyzer 中的字符过滤器如何利用?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.1.2.</span> <span class="nav-text">REST API在 Elasticsearch 方面有哪些优势?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.1.3.</span> <span class="nav-text">Elasticsearch 中常用的 cat命令有哪些?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.1.4.</span> <span class="nav-text">你能否列出与 Elasticsearch 有关的主要可用字段数据类型?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.1.5.</span> <span class="nav-text">Elasticsearch了解多少，说说你们公司es的集群架构，索引数据 大小，分片有多少，以及一些调优手段 。</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">写入调优</span></a></li><li class="nav-item nav-level-5"><a class="nav-link"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">查询调优</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.2.</span> <span class="nav-text">详细描述一下 Elasticsearch 搜索的过程？</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.1.</span> <span class="nav-text">Elasticsearch 在部署时，对 Linux 的设置有哪些优化方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.2.</span> <span class="nav-text">解释一下 Elasticsearch集群中的 索引的概念 ?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.3.</span> <span class="nav-text">lucence 内部结构是什么</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.4.</span> <span class="nav-text">Elasticsearch 是如何实现 Master 选举的？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.5.</span> <span class="nav-text">Elasticsearch 索引数据多了怎么办，如何调优，部署</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.6.</span> <span class="nav-text">在 Elasticsearch 中删除索引的语法是什么? 可以使用以下语法删除现有索引:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.7.</span> <span class="nav-text">在 Elasticsearch 中列出集群的所有索引的语法是什么?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.8.</span> <span class="nav-text">在索引中更新 Mapping 的语法?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.9.</span> <span class="nav-text">ES 写数据过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.10.</span> <span class="nav-text">ES 读数据过程 可以通过 来查询，会根据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.11.</span> <span class="nav-text">ES中的倒排索引是什么?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.12.</span> <span class="nav-text">请解释在 Elasticsearch 集群中添加或创建索引的过程? 要添加新索引，应使用创建索引 API 选项。创建索引所需的参数是索引的配置Settings，索引中的字段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.13.</span> <span class="nav-text">详细描述一下Elasticsearch索引文档的过程。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.14.</span> <span class="nav-text">详细描述一下Elasticsearch搜索的过程 搜索被执行成一个两阶段过程，我们称之为 Query Then Fetch;</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.15.</span> <span class="nav-text">Elasticsearch对于大数据量(上亿量级)的聚合如何实现?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.16.</span> <span class="nav-text">你可以列出 Elasticsearch 各种类型的分析器吗?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.17.</span> <span class="nav-text">ES是如何实现master选举的?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.18.</span> <span class="nav-text">Master 节点和 候选 Master节点有什么区别? 主节点负责集群相关的操作，例如创建或删除索引，跟踪哪些节点是集群的一部分，以及决定将哪些分片分配给哪些节点。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.19.</span> <span class="nav-text">Elasticsearch中的属性 enabled, index 和 store 的功能是什 么?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.20.</span> <span class="nav-text">Elasticsearch中的节点(比如共20个)，其中的10个选了一个 master，另外10个选了另一个master，怎么办?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.21.</span> <span class="nav-text">如何解决ES集群的脑裂问题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.22.</span> <span class="nav-text">详细描述一下ES索引文档的过程?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.23.</span> <span class="nav-text">详细描述一下ES更新和删除文档的过程?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.24.</span> <span class="nav-text">详细描述一下ES搜索的过程?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.25.</span> <span class="nav-text">在并发情况下，ES如果保证读写一致?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.26.</span> <span class="nav-text">ES对于大数据量(上亿量级)的聚合如何实现?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.27.</span> <span class="nav-text">对于GC方面，在使用ES时要注意什么?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.28.</span> <span class="nav-text">说说你们公司ES的集群架构，索引数据大小，分片有多少，以及 一些调优手段?</span></a></li><li class="nav-item nav-level-4"><a class="nav-link"><span class="nav-number">1.2.29.</span> <span class="nav-text">在并发情况下，Elasticsearch如果保证读写一致? 可以通过版本号使用乐观并发控制，以确保新版本不会被旧版本覆盖，由应用层来处理具体的冲突;</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Java面试题"
      src="/images/avator.jpg">
  <p class="site-author-name" itemprop="name">Java面试题</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">20</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lvdXJuYW1l" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yourname"><i class="fa fa-fw fa-github"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjQxMTM3MjY5OEBxcS5jb20=" title="E-Mail → mailto:411372698@qq.com"><i class="fa fa-fw fa-envelope"></i>E-Mail</span>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
  </div>
  <div class="">
    <a target="_blank" class="social-link" href="/atom.xml" style="color: burlywood;">
      <span class="icon">
        <i class="fa fa-rss"></i>
      </span>
      <span class="label">RSS</span>
    </a>
  </div>


      </div>
      <div class="wechat_channel">
        <br>
        <!-- 这里添加你的二维码图片 -->
       <!-- <img src ="/images/qq3.png"> -->
        <!-- <span>公众号</span> -->
      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Java面试题</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">480k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">7:16</span>
</div>
<!--
  <div class="powered-by">由 <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl theme-link" data-url="aHR0cHM6Ly90aGVtZS1uZXh0Lm9yZw==">NexT.Gemini</span> 强力驱动
  </div>
-->

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>

<script src="/js/utils.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script>
  <script>
      pbOptions = {};
        pbOptions.iconStyle = "box";
        pbOptions.boxForm = "horizontal";
        pbOptions.position = "bottomCenter";
        pbOptions.networks = "Wechat,QQZone,Weibo,Douban,Twitter,Facebook";
      new needShareButton('#needsharebutton-postbottom', pbOptions);
  </script>

<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'EDfxKBz26FtQh3sqkO5qVsUE-MdYXbMMI',
      appKey     : 'IflJyLSMyiq3XCknVe0vtjEm',
      placeholder: "Just go go",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : 'https://EDfxKBz2.api.lncldglobal.com'
    });
  }, window.Valine);
});
</script>

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true}});</script></body>
<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/clicklove.js"></script>
</html>
